# JAM-017: Badge System

**Priority**: ðŸŸ¡ Medium  
**Effort**: 2-3 hours  
**Dependencies**: JAM-008 (quest tracking)

## ðŸ“‹ Objective

Implement a badge system to recognize participant achievements and milestones. Badges provide gamification and motivation for continued participation.

## âœ… Acceptance Criteria

- [ ] Badge definitions and criteria
- [ ] Automatic badge awarding
- [ ] Badge display on profiles
- [ ] Badge showcase page
- [ ] Social sharing of badges
- [ ] Admin badge management

## ðŸ› ï¸ Implementation

### Files to Create/Modify

- `src/lib/jam/badges.ts` - Badge logic
- `src/components/jam-platform/badges/BadgeDisplay.tsx`
- `src/app/jam/badges/page.tsx` - Badge showcase
- `src/app/api/jam/badges/route.ts` - Badge API

### Badge Definitions

````typescript
// src/lib/jam/badges.ts
export const BADGES = {\n  // Onboarding Badges\n  first_steps: {\n    name: 'First Steps',\n    description: 'Completed profile setup',\n    icon: 'ðŸ‘‹',\n    category: 'onboarding',\n    criteria: 'Complete onboarding flow',\n    rarity: 'common'\n  },\n  \n  // Quest Badges\n  quest_starter: {\n    name: 'Quest Starter',\n    description: 'Completed your first quest',\n    icon: 'ðŸŽ¯',\n    category: 'quests',\n    criteria: 'Complete 1 quest',\n    rarity: 'common'\n  },\n  quest_warrior: {\n    name: 'Quest Warrior',\n    description: 'Completed 10 quests',\n    icon: 'âš”ï¸',\n    category: 'quests',\n    criteria: 'Complete 10 quests',\n    rarity: 'uncommon'\n  },\n  quest_master: {\n    name: 'Quest Master',\n    description: 'Completed 25 quests',\n    icon: 'ðŸ‘‘',\n    category: 'quests',\n    criteria: 'Complete 25 quests',\n    rarity: 'rare'\n  },\n  \n  // Project Badges\n  ideator: {\n    name: 'Ideator',\n    description: 'Advanced project to PROTOTYPE stage',\n    icon: 'ðŸ’¡',\n    category: 'project',\n    criteria: 'Reach PROTOTYPE stage',\n    rarity: 'common'\n  },\n  builder: {\n    name: 'Builder',\n    description: 'Advanced project to BUILD stage',\n    icon: 'ðŸ”¨',\n    category: 'project',\n    criteria: 'Reach BUILD stage',\n    rarity: 'uncommon'\n  },\n  finisher: {\n    name: 'Finisher',\n    description: 'Completed full project',\n    icon: 'ðŸ†',\n    category: 'project',\n    criteria: 'Reach PROJECT stage',\n    rarity: 'rare'\n  },\n  \n  // Community Badges\n  storyteller: {\n    name: 'Storyteller',\n    description: 'Shared 5 Build in Public posts',\n    icon: 'ðŸ“',\n    category: 'community',\n    criteria: 'Create 5 posts',\n    rarity: 'uncommon'\n  },\n  \n  // Mentorship Badges\n  mentee: {\n    name: 'Mentee',\n    description: 'Connected with a mentor',\n    icon: 'ðŸ¤',\n    category: 'mentorship',\n    criteria: 'Get matched with mentor',\n    rarity: 'common'\n  },\n  \n  // Special Badges\n  early_adopter: {\n    name: 'Early Adopter',\n    description: 'One of the first 100 participants',\n    icon: 'ðŸŒŸ',\n    category: 'special',\n    criteria: 'Join in first cohort',\n    rarity: 'legendary'\n  }\n};\n\nexport async function checkAndAwardBadges(userId: string) {\n  const user = await getUserWithStats(userId);\n  const userBadges = await getUserBadges(userId);\n  const earnedBadgeIds = userBadges.map(b => b.badgeId);\n  \n  // Check each badge criteria\n  for (const [badgeId, badge] of Object.entries(BADGES)) {\n    if (earnedBadgeIds.includes(badgeId)) continue;\n    \n    const earned = await checkBadgeCriteria(badgeId, user);\n    if (earned) {\n      await awardBadge(userId, badgeId);\n      await notifyBadgeEarned(userId, badge);\n    }\n  }\n}\n\nasync function checkBadgeCriteria(badgeId: string, user: any): Promise<boolean> {\n  switch (badgeId) {\n    case 'first_steps':\n      return user.onboardingComplete;\n    \n    case 'quest_starter':\n      return user.completedQuests >= 1;\n    \n    case 'quest_warrior':\n      return user.completedQuests >= 10;\n    \n    case 'quest_master':\n      return user.completedQuests >= 25;\n    \n    case 'ideator':\n      return user.project?.stage === 'PROTOTYPE' || \n             ['BUILD', 'PROJECT'].includes(user.project?.stage);\n    \n    case 'builder':\n      return user.project?.stage === 'BUILD' || \n             user.project?.stage === 'PROJECT';\n    \n    case 'finisher':\n      return user.project?.stage === 'PROJECT';\n    \n    case 'storyteller':\n      return user.postCount >= 5;\n    \n    case 'mentee':\n      return user.hasMentor;\n    \n    case 'early_adopter':\n      return user.userId <= 100; // First 100 users\n    \n    default:\n      return false;\n  }\n}\n```\n\n### Badge Display Component\n\n```tsx\n// src/components/jam-platform/badges/BadgeDisplay.tsx\nexport function BadgeDisplay({ badges, showAll = false }) {\n  const displayedBadges = showAll ? badges : badges.slice(0, 6);\n  \n  return (\n    <div className=\"space-y-4\">\n      <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4\">\n        {displayedBadges.map(userBadge => {\n          const badge = BADGES[userBadge.badgeId];\n          return (\n            <BadgeCard \n              key={userBadge.id} \n              badge={badge} \n              earnedAt={userBadge.earnedAt}\n            />\n          );\n        })}\n      </div>\n      \n      {!showAll && badges.length > 6 && (\n        <div className=\"text-center\">\n          <Button variant=\"outline\" asChild>\n            <Link href=\"/jam/badges\">\n              View All {badges.length} Badges\n            </Link>\n          </Button>\n        </div>\n      )}\n    </div>\n  );\n}\n\nfunction BadgeCard({ badge, earnedAt }) {\n  return (\n    <div className=\"group relative\">\n      <Card className=\"text-center p-4 hover:shadow-lg transition-shadow\">\n        <div className=\"text-3xl mb-2\">{badge.icon}</div>\n        <h3 className=\"font-medium text-sm\">{badge.name}</h3>\n        <p className=\"text-xs text-foreground mt-1\">\n          {badge.description}\n        </p>\n        \n        <Badge \n          variant=\"secondary\" \n          className={cn(\n            \"mt-2 text-xs\",\n            badge.rarity === 'legendary' && \"bg-yellow-500 text-yellow-50\",\n            badge.rarity === 'rare' && \"bg-purple-500 text-purple-50\",\n            badge.rarity === 'uncommon' && \"bg-blue-500 text-blue-50\"\n          )}\n        >\n          {badge.rarity}\n        </Badge>\n      </Card>\n      \n      {earnedAt && (\n        <Tooltip>\n          <TooltipTrigger className=\"absolute -top-1 -right-1\">\n            <div className=\"w-4 h-4 bg-green-500 rounded-full border-2 border-background\" />\n          </TooltipTrigger>\n          <TooltipContent>\n            Earned {formatDate(earnedAt)}\n          </TooltipContent>\n        </Tooltip>\n      )}\n    </div>\n  );\n}\n```\n\n### Badge Showcase Page\n\n```tsx\n// src/app/jam/badges/page.tsx\nexport default async function BadgesPage() {\n  const user = await getCurrentUser();\n  const userBadges = await getUserBadges(user.id);\n  const earnedBadgeIds = userBadges.map(b => b.badgeId);\n  \n  const categorizedBadges = Object.entries(BADGES).reduce((acc, [id, badge]) => {\n    if (!acc[badge.category]) acc[badge.category] = [];\n    acc[badge.category].push({\n      id,\n      ...badge,\n      earned: earnedBadgeIds.includes(id),\n      earnedAt: userBadges.find(b => b.badgeId === id)?.earnedAt\n    });\n    return acc;\n  }, {} as Record<string, any[]>);\n  \n  return (\n    <div className=\"container py-6\">\n      <div className=\"text-center mb-8\">\n        <h1 className=\"text-3xl font-bold\">Badge Collection</h1>\n        <p className=\"text-foreground mt-2\">\n          Earn badges by completing quests, reaching milestones, and engaging with the community\n        </p>\n        \n        <div className=\"flex justify-center gap-6 mt-4\">\n          <div className=\"text-center\">\n            <div className=\"text-2xl font-bold\">{userBadges.length}</div>\n            <div className=\"text-sm text-foreground\">Badges Earned</div>\n          </div>\n          <div className=\"text-center\">\n            <div className=\"text-2xl font-bold\">{Object.keys(BADGES).length}</div>\n            <div className=\"text-sm text-foreground\">Total Available</div>\n          </div>\n        </div>\n      </div>\n      \n      <div className=\"space-y-8\">\n        {Object.entries(categorizedBadges).map(([category, badges]) => (\n          <BadgeCategory \n            key={category}\n            title={category.charAt(0).toUpperCase() + category.slice(1)}\n            badges={badges}\n          />\n        ))}\n      </div>\n    </div>\n  );\n}\n\nfunction BadgeCategory({ title, badges }) {\n  return (\n    <div>\n      <h2 className=\"text-xl font-semibold mb-4\">{title}</h2>\n      <div className=\"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4\">\n        {badges.map(badge => (\n          <div key={badge.id} className={cn(\n            \"relative\",\n            !badge.earned && \"opacity-50 grayscale\"\n          )}>\n            <BadgeCard badge={badge} earnedAt={badge.earnedAt} />\n            {!badge.earned && (\n              <div className=\"absolute inset-0 flex items-center justify-center bg-background/80 rounded-lg\">\n                <Lock className=\"h-6 w-6 text-foreground\" />\n              </div>\n            )}\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n}\n```\n\n### Badge API\n\n```typescript\n// src/app/api/jam/badges/award/route.ts (Admin only)\nexport const POST = withAdmin(async (request: Request) => {\n  const { userId, badgeId, reason } = await request.json();\n  \n  // Check if badge exists\n  if (!BADGES[badgeId]) {\n    throw new ValidationError('Invalid badge ID');\n  }\n  \n  // Check if already awarded\n  const existing = await db.select()\n    .from(userBadgesTable)\n    .where(\n      and(\n        eq(userBadgesTable.userId, userId),\n        eq(userBadgesTable.badgeId, badgeId)\n      )\n    )\n    .limit(1);\n    \n  if (existing[0]) {\n    throw new ConflictError('Badge already awarded');\n  }\n  \n  // Award badge\n  await awardBadge(userId, badgeId, reason);\n  \n  return successResponse({ awarded: true }, 'Badge awarded successfully');\n});\n```\n\n## ðŸŽ¯ Testing\n\n1. **Badge awarding**\n   - Automatic triggers work\n   - No duplicate awards\n   - Notifications sent\n\n2. **Badge display**\n   - Earned badges highlighted\n   - Locked badges grayed out\n   - Categories organized\n\n3. **Badge sharing**\n   - Social sharing works\n   - Badge URLs functional\n\n## ðŸ’¡ Notes\n\n- Start with simple badge set\n- Add animated badge notifications\n- Consider badge leaderboards\n- Enable badge trading later\n\n## ðŸš¨ Potential Issues\n\n- **Performance**: Cache badge checks\n- **Fairness**: Prevent badge gaming\n- **Retroactive**: Award badges to existing users\n- **Rarity balance**: Adjust badge difficulty
````
