# JAM-014: Basic Admin Controls

**Priority**: üü° High  
**Effort**: 3-4 hours  
**Dependencies**: JAM-006 (API structure)

## üìã Objective

Create basic admin interface for program coordinators to manage participants, mentors, quests, and track program health.

## ‚úÖ Acceptance Criteria

- [ ] Admin dashboard with key metrics
- [ ] User management (participants & mentors)
- [ ] Quest management (create, edit, assign)
- [ ] Program oversight tools
- [ ] Basic analytics and reporting
- [ ] Manual intervention capabilities

## üõ†Ô∏è Implementation

### Files to Create/Modify

- `src/app/admin/page.tsx` - Admin dashboard
- `src/app/admin/users/page.tsx` - User management
- `src/app/admin/quests/page.tsx` - Quest management
- `src/components/admin/` - Admin components
- `src/lib/admin/` - Admin utilities

### Admin Dashboard

```tsx
// src/app/admin/page.tsx
export default async function AdminDashboard() {
  const stats = await getAdminStats()

  return (
    <div className="container py-6">
      <h1 className="mb-6 text-3xl font-bold">Program Administration</h1>

      <div className="mb-8 grid gap-4 md:grid-cols-4">
        <StatsCard
          title="Active Participants"
          value={stats.activeParticipants}
          change="+12 this week"
          icon={Users}
        />
        <StatsCard
          title="Available Mentors"
          value={stats.availableMentors}
          change="3 new mentors"
          icon={UserCheck}
        />
        <StatsCard
          title="Completion Rate"
          value={`${stats.completionRate}%`}
          change="+5% vs last cohort"
          icon={TrendingUp}
        />
        <StatsCard
          title="Active Programs"
          value={stats.activePrograms}
          change="2 ending soon"
          icon={Calendar}
        />
      </div>

      <div className="grid gap-6 md:grid-cols-2">
        <ParticipantProgress participants={stats.recentActivity} />
        <MentorshipHealth mentorships={stats.mentorshipHealth} />
        <QuestCompletionTrends data={stats.questTrends} />
        <ProgramEnrollments data={stats.programEnrollments} />
      </div>
    </div>
  )
}
```

### User Management

```tsx
// src/app/admin/users/page.tsx
export default async function AdminUsersPage() {
  const users = await getAllUsers()

  return (
    <div className="container py-6">
      <div className="mb-6 flex items-center justify-between">
        <h1 className="text-3xl font-bold">User Management</h1>
        <div className="flex gap-2">
          <Button variant="outline">
            <Download className="mr-2 h-4 w-4" />
            Export CSV
          </Button>
          <Button>
            <Plus className="mr-2 h-4 w-4" />
            Add User
          </Button>
        </div>
      </div>

      <UserFilters />

      <Card>
        <Table>
          <TableHeader>
            <TableRow>
              <TableHead>User</TableHead>
              <TableHead>Track</TableHead>
              <TableHead>Progress</TableHead>
              <TableHead>Mentor</TableHead>
              <TableHead>Status</TableHead>
              <TableHead>Actions</TableHead>
            </TableRow>
          </TableHeader>
          <TableBody>
            {users.map((user) => (
              <TableRow key={user.id}>
                <TableCell>
                  <div className="flex items-center gap-2">
                    <Avatar className="h-8 w-8">
                      <AvatarImage src={user.avatarUrl} />
                      <AvatarFallback>{user.displayName.slice(0, 2)}</AvatarFallback>
                    </Avatar>
                    <div>
                      <div className="font-medium">{user.displayName}</div>
                      <div className="text-foreground text-sm">{user.email}</div>
                    </div>
                  </div>
                </TableCell>
                <TableCell>
                  <Badge variant="secondary">{user.track}</Badge>
                </TableCell>
                <TableCell>
                  <div className="space-y-1">
                    <Progress value={user.progress} className="h-2" />
                    <div className="text-foreground text-xs">
                      {user.completedQuests}/{user.totalQuests} quests
                    </div>
                  </div>
                </TableCell>
                <TableCell>
                  {user.mentor ? (
                    <div className="text-sm">{user.mentor.displayName}</div>
                  ) : (
                    <Badge variant="outline">No mentor</Badge>
                  )}
                </TableCell>
                <TableCell>
                  <Badge variant={user.status === 'active' ? 'default' : 'secondary'}>
                    {user.status}
                  </Badge>
                </TableCell>
                <TableCell>
                  <AdminUserActions user={user} />
                </TableCell>
              </TableRow>
            ))}
          </TableBody>
        </Table>
      </Card>
    </div>
  )
}
```

### Quest Management

```tsx
// src/app/admin/quests/page.tsx
export default async function AdminQuestsPage() {
  const quests = await getAllQuests()

  return (
    <div className="container py-6">
      <div className="mb-6 flex items-center justify-between">
        <h1 className="text-3xl font-bold">Quest Management</h1>
        <Button>
          <Plus className="mr-2 h-4 w-4" />
          Create Quest
        </Button>
      </div>

      <Tabs defaultValue="active">
        <TabsList>
          <TabsTrigger value="active">Active Quests</TabsTrigger>
          <TabsTrigger value="draft">Drafts</TabsTrigger>
          <TabsTrigger value="templates">Templates</TabsTrigger>
        </TabsList>

        <TabsContent value="active">
          <QuestTable quests={quests.active} />
        </TabsContent>
      </Tabs>
    </div>
  )
}

function QuestTable({ quests }) {
  return (
    <Card>
      <Table>
        <TableHeader>
          <TableRow>
            <TableHead>Quest</TableHead>
            <TableHead>Track</TableHead>
            <TableHead>Week</TableHead>
            <TableHead>Completion Rate</TableHead>
            <TableHead>Actions</TableHead>
          </TableRow>
        </TableHeader>
        <TableBody>
          {quests.map((quest) => (
            <TableRow key={quest.id}>
              <TableCell>
                <div>
                  <div className="font-medium">{quest.title}</div>
                  <div className="text-foreground text-sm">
                    {quest.category} ‚Ä¢ {quest.difficulty}
                  </div>
                </div>
              </TableCell>
              <TableCell>
                <Badge variant="secondary">{quest.track}</Badge>
              </TableCell>
              <TableCell>Week {quest.week}</TableCell>
              <TableCell>
                <div className="flex items-center gap-2">
                  <Progress value={quest.completionRate} className="h-2 w-16" />
                  <span className="text-sm">{quest.completionRate}%</span>
                </div>
              </TableCell>
              <TableCell>
                <AdminQuestActions quest={quest} />
              </TableCell>
            </TableRow>
          ))}
        </TableBody>
      </Table>
    </Card>
  )
}
```

### Admin Actions

```tsx
// src/components/admin/AdminUserActions.tsx
export function AdminUserActions({ user }) {
  return (
    <DropdownMenu>
      <DropdownMenuTrigger asChild>
        <Button variant="ghost" size="sm">
          <MoreHorizontal className="h-4 w-4" />
        </Button>
      </DropdownMenuTrigger>
      <DropdownMenuContent>
        <DropdownMenuItem>
          <UserCog className="mr-2 h-4 w-4" />
          Edit Profile
        </DropdownMenuItem>
        <DropdownMenuItem>
          <MessageSquare className="mr-2 h-4 w-4" />
          Send Message
        </DropdownMenuItem>
        <DropdownMenuItem>
          <Users className="mr-2 h-4 w-4" />
          Assign Mentor
        </DropdownMenuItem>
        <DropdownMenuItem>
          <Award className="mr-2 h-4 w-4" />
          Award Badge
        </DropdownMenuItem>
        <DropdownMenuSeparator />
        <DropdownMenuItem className="text-red-600">
          <UserX className="mr-2 h-4 w-4" />
          Suspend User
        </DropdownMenuItem>
      </DropdownMenuContent>
    </DropdownMenu>
  )
}
```

### Admin Protection

```typescript
// src/lib/admin/auth.ts
export async function requireAdmin(request: Request) {
  const user = await authenticate(request)

  if (!user.isAdmin) {
    throw new ForbiddenError('Admin access required')
  }

  return user
}

export const withAdmin = (handler: Function) => {
  return async (request: Request, ...args: any[]) => {
    await requireAdmin(request)
    return handler(request, ...args)
  }
}
```

## üéØ Testing

- Admin dashboard loads correctly
- User actions work properly
- Quest management functional
- Analytics display accurately

## üí° Notes

- Start with read-only analytics
- Add bulk actions later
- Consider admin notifications
- Track admin action audit trail

## üö® Potential Issues

- **Access control**: Verify admin permissions
- **Bulk operations**: Handle large datasets
- **Data consistency**: Validate admin changes
- **Audit trail**: Log all admin actions
