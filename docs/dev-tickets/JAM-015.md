# JAM-015: Build in Public Posts

**Priority**: üü° Medium  
**Effort**: 3-4 hours  
**Dependencies**: JAM-004 (projects)

## üìã Objective

Enable participants to create "Build in Public" posts to share their progress, learnings, and project updates with the community. This builds their reputation and creates engagement.

## ‚úÖ Acceptance Criteria

- [ ] Post creation form with rich text
- [ ] Link posts to projects
- [ ] Image upload support (optional)
- [ ] Tag system for categorization
- [ ] Public post pages (shareable URLs)
- [ ] Draft/publish functionality

## üõ†Ô∏è Implementation

### Files to Create/Modify

- `src/app/jam/community/create/page.tsx` - Post creation
- `src/app/jam/posts/[id]/page.tsx` - Post detail page
- `src/components/jam-platform/community/PostEditor.tsx`
- `src/app/api/jam/posts/route.ts` - Posts API

### Post Creation Form

```tsx
// src/components/jam-platform/community/PostEditor.tsx
export function PostEditor({ onSubmit, initialPost }) {
  const [title, setTitle] = useState(initialPost?.title || '')
  const [content, setContent] = useState(initialPost?.content || '')
  const [tags, setTags] = useState<string[]>(initialPost?.tags || [])
  const [projectId, setProjectId] = useState(initialPost?.projectId || '')
  const [isDraft, setIsDraft] = useState(true)

  return (
    <Card>
      <CardHeader>
        <CardTitle>Share Your Progress</CardTitle>
        <CardDescription>
          Tell the community what you're building and what you've learned
        </CardDescription>
      </CardHeader>

      <CardContent>
        <form onSubmit={handleSubmit} className="space-y-4">
          <div>
            <Label>Title</Label>
            <Input
              value={title}
              onChange={(e) => setTitle(e.target.value)}
              placeholder="What did you accomplish today?"
              required
            />
          </div>

          <div>
            <Label>Content</Label>
            <Textarea
              value={content}
              onChange={(e) => setContent(e.target.value)}
              placeholder="Share your story, learnings, challenges, or wins..."
              rows={8}
              required
            />
            <p className="text-foreground mt-1 text-xs">Supports Markdown formatting</p>
          </div>

          <div>
            <Label>Link to Project (Optional)</Label>
            <ProjectSelector selectedProject={projectId} onSelect={setProjectId} />
          </div>

          <div>
            <Label>Tags</Label>
            <TagInput
              tags={tags}
              onChange={setTags}
              suggestions={['learning', 'progress', 'challenge', 'win', 'demo']}
            />
          </div>

          <div className="flex items-center gap-4">
            <div className="flex items-center space-x-2">
              <Switch
                id="publish"
                checked={!isDraft}
                onCheckedChange={(checked) => setIsDraft(!checked)}
              />
              <Label htmlFor="publish">{isDraft ? 'Save as Draft' : 'Publish Now'}</Label>
            </div>

            <div className="ml-auto flex gap-2">
              <Button type="button" variant="outline">
                Save Draft
              </Button>
              <Button type="submit">{isDraft ? 'Save Draft' : 'Publish Post'}</Button>
            </div>
          </div>
        </form>
      </CardContent>
    </Card>
  )
}
```

### Tag Input Component

```tsx
// src/components/jam-platform/community/TagInput.tsx
export function TagInput({ tags, onChange, suggestions = [] }) {
  const [inputValue, setInputValue] = useState('')

  const addTag = (tag: string) => {
    const trimmed = tag.trim().toLowerCase()
    if (trimmed && !tags.includes(trimmed)) {
      onChange([...tags, trimmed])
    }
    setInputValue('')
  }

  const removeTag = (tagToRemove: string) => {
    onChange(tags.filter((tag) => tag !== tagToRemove))
  }

  return (
    <div className="space-y-2">
      <div className="flex flex-wrap gap-2">
        {tags.map((tag) => (
          <Badge key={tag} variant="secondary">
            {tag}
            <Button
              variant="ghost"
              size="sm"
              className="ml-2 h-4 w-4 p-0"
              onClick={() => removeTag(tag)}
            >
              <X className="h-3 w-3" />
            </Button>
          </Badge>
        ))}
      </div>

      <div className="relative">
        <Input
          value={inputValue}
          onChange={(e) => setInputValue(e.target.value)}
          onKeyDown={(e) => {
            if (e.key === 'Enter' || e.key === ',') {
              e.preventDefault()
              addTag(inputValue)
            }
          }}
          placeholder="Add tags... (press Enter or comma to add)"
        />

        {inputValue && suggestions.length > 0 && (
          <div className="bg-background absolute left-0 right-0 top-full z-10 rounded-md border shadow-lg">
            {suggestions
              .filter((s) => s.includes(inputValue.toLowerCase()))
              .map((suggestion) => (
                <button
                  key={suggestion}
                  className="hover:bg-muted w-full px-3 py-2 text-left"
                  onClick={() => addTag(suggestion)}
                >
                  {suggestion}
                </button>
              ))}
          </div>
        )}
      </div>
    </div>
  )
}
```

### Post API

```typescript
// src/app/api/jam/posts/route.ts
export const POST = withAuth(async (request: Request) => {
  const data = await request.json();
  const userId = request.user.id;

  // Validate input
  if (!data.title || !data.content) {
    throw new ValidationError('Title and content required');
  }

  // Create slug from title
  const slug = generateSlug(data.title);

  // Create post
  const post = await db.insert(postsTable).values({
    title: data.title,
    content: data.content,
    slug,
    tags: data.tags || [],
    authorId: userId,
    projectId: data.projectId || null,
    isDraft: data.isDraft || false,
    createdAt: new Date()
  }).returning();

  // If published, notify followers (future feature)
  if (!data.isDraft) {
    await notifyFollowers(userId, post[0].id);
  }

  return successResponse(post[0], 'Post created successfully');
});

export const GET = async (request: Request) => {
  const { searchParams } = new URL(request.url);
  const tag = searchParams.get('tag');
  const author = searchParams.get('author');
  const project = searchParams.get('project');

  let query = db.select({
    id: postsTable.id,
    title: postsTable.title,
    content: postsTable.content,
    slug: postsTable.slug,
    tags: postsTable.tags,
    createdAt: postsTable.createdAt,
    author: {
      id: usersTable.id,
      displayName: usersTable.displayName,
      avatarUrl: usersTable.avatarUrl
    },
    project: {
      id: projectsTable.id,
      name: projectsTable.name,
      slug: projectsTable.slug
    }
  })
  .from(postsTable)
  .innerJoin(usersTable, eq(postsTable.authorId, usersTable.id))
  .leftJoin(projectsTable, eq(postsTable.projectId, projectsTable.id))
  .where(eq(postsTable.isDraft, false));

  // Apply filters
  if (tag) {
    query = query.where(sql`${postsTable.tags} @> ARRAY[${tag}]`);
  }
  if (author) {
    query = query.where(eq(postsTable.authorId, author));
  }
  if (project) {
    query = query.where(eq(postsTable.projectId, project));
  }

  const posts = await query
    .orderBy(desc(postsTable.createdAt))
    .limit(20);

  return successResponse(posts);
});
```

### Post Detail Page

```tsx
// src/app/jam/posts/[slug]/page.tsx
export default async function PostDetailPage({ params }) {
  const post = await getPostBySlug(params.slug)

  if (!post) notFound()

  return (
    <div className="container max-w-4xl py-6">
      <PostHeader post={post} />

      <article className="prose prose-neutral dark:prose-invert mt-6 max-w-none">
        <h1>{post.title}</h1>
        <ReactMarkdown>{post.content}</ReactMarkdown>
      </article>

      <div className="mt-8">
        <PostTags tags={post.tags} />
        <PostAuthor author={post.author} />
        {post.project && <PostProject project={post.project} />}
      </div>

      <div className="mt-8">
        <SocialShare post={post} />
      </div>
    </div>
  )
}
```

## üéØ Testing

1. **Post creation**
   - Form validates properly
   - Draft/publish works
   - Tags save correctly

2. **Post display**
   - Markdown renders
   - Images display
   - Links functional

3. **Sharing**
   - Public URLs work
   - Social sharing functional

## üí° Notes

- Start with simple markdown editor
- Consider rich text editor later
- Enable image uploads with R2
- Add social media auto-posting

## üö® Potential Issues

- **Content moderation**: No filtering initially
- **Spam prevention**: Rate limit post creation
- **SEO**: Add meta tags for sharing
- **Performance**: Paginate post lists
